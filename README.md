# ë©”ì„¸ì§€ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤ âœ‰ [![CI/CD](https://github.com/SJ0826/random-message-project/actions/workflows/CICD.yml/badge.svg)](https://github.com/SJ0826/random-message-project/actions/workflows/CICD.yml)

![image](https://user-images.githubusercontent.com/56298540/230632302-d7833ce6-66de-4032-9bee-3487d860322b.png)

## ğŸš©í”„ë¡œì íŠ¸ ì„¤ëª…

**ë©”ì„¸ì§€ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤âœ‰**ëŠ” ìµëª…ì˜ ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” **ëœë¤ ë©”ì‹ ì €**ì…ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ìµëª… ë©”ì‹œì§€ë¥¼ ë°›ê¸° ìœ„í•´ í•˜ë‚˜ì˜ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤. ìµëª…ì˜ ëˆ„êµ°ê°€ì™€ ë©”ì‹œì§€ë¥¼ ì£¼ê³  ë°›ëŠ” ê³¼ì •ì—ì„œ ë‚¯ì„  ìƒˆë¡œì›€ê³¼ ì„¤ë ˆì„ì„ ì œê³µí•˜ê³ ì í”„ë¡œì íŠ¸ë¥¼ ê¸°íší–ˆìŠµë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” ëˆ„êµ¬ë‚˜ ì°¸ì—¬í•  ìˆ˜ ìˆìœ¼ë©°, ì°¸ì—¬ ë°©ë²•ì€ ë§¤ìš° ê°„ë‹¨í•©ë‹ˆë‹¤. ìš°ì„  ì´ë¦„ê³¼ ë©”ì‹œì§€ì˜ ë‚´ìš©ì„ ì‘ì„±í•´ ë“±ë¡í•˜ë©´, ì„œë²„ì—ì„œ ì‚¬ìš©ì ì •ë³´ë¥¼ ë¬´ì‘ìœ„ë¡œ ì¶”ì¶œí•˜ì—¬ ìƒëŒ€ë°©ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë©”ì‹œì§€ë¥¼ ë°›ì€ ì‚¬ìš©ìëŠ” ìµëª…ìœ¼ë¡œ ë˜ë‹¤ë¥¸ ìƒëŒ€ë°©ì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìœ¼ë©°, ì´ëŸ¬í•œ ê³¼ì •ì—ì„œ ëœë¤í•œ ìƒëŒ€ë°©ê³¼ ì†Œí†µí•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì œê³µí•©ë‹ˆë‹¤.

í•œë²ˆ ì „ì†¡ëœ ë©”ì„¸ì§€ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚­ì œë˜ì–´, ì‚¬ìš©ìì˜ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê³  ì•ˆì •ì„±ì„ ë†’ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë©”ì„¸ì§€ê°€ ë”ìš± ì•ˆì „í•˜ê²Œ ì „ì†¡ë˜ë©°, ë¶ˆí•„ìš”í•œ ë°ì´í„° ë³´ê´€ì„ í”¼í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì˜ íš¨ìœ¨ì„±ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì‚­ì œëœ ë©”ì„¸ì§€ëŠ” ë”ì´ìƒ ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ, ë©”ì„¸ì§€ì˜ ê¸°ë°€ì„±ê³¼ ë³´ì•ˆì„ ê°•í™”í•˜ì—¬ ë”ìš± ì‹ ë¢°ì„± ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™€ ê°™ì´ ì•ˆì „ì„±ì„ ë†’ì¸ ê¸°ëŠ¥ì€ ì‚¬ìš©ìë“¤ì˜ ê°œì¸ ì •ë³´ ë³´í˜¸ì™€ ë°ì´í„° ê´€ë¦¬ë¥¼ ì ê·¹ì ìœ¼ë¡œ ê³ ë ¤í•œ í˜„ëŒ€ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ ê°€ì¹˜ë¥¼ ë°˜í˜•í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ğŸ“‘ ì´ í”„ë¡œì íŠ¸ëŠ” **ìµëª…ì„±**ê³¼ **ë¬´ì‘ìœ„ì„±**ì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ì‚¬ìš©ìì˜ ê°œì¸ ì •ë³´ë¥¼ ì €ì¥í•˜ì§€ ì•Šì•„ **ì•ˆì •ì„±**ì„ ë³´ì¥í•©ë‹ˆë‹¤.

## âœ” í”„ë¡œì íŠ¸ ì‚´í´ë³´ê¸°
[âœ‰ ë°°í¬ë§í¬](http://random-message.s3-website.ap-northeast-2.amazonaws.com/)

```
git clone https://github.com/SJ0826/random-message-project.git
cd random-message-project
yarn install ë˜ëŠ” npm install
```

## ğŸ”¨ ê¸°ìˆ  ìŠ¤íƒ

- **TypeScript** : ì •ì  ì–¸ì–´ì¸ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œì˜ ì•ˆì •ì„±ì„ ë†’ì…ë‹ˆë‹¤.
- **React**: ëª¨ë“ˆì„±ì´ ë†’ê³  ìœ ì§€ë³´ìˆ˜ì— ìœ ë¦¬í•©ë‹ˆë‹¤.
- **Recoil**: ì „ì—­ ìƒíƒœê´€ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. í”„ë¡œì íŠ¸ì˜ í¬ê¸°ê°€ í¬ì§€ ì•Šì•„ ReduxëŒ€ì‹  ë„ì…í–ˆìŠµë‹ˆë‹¤.
- **Sass**: CSSê°€ ê°€ì§„ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì„ ì§€ì›í•˜ë©° ë¯¹ìŠ¤ì¸ ë“±ì˜ ê¸°ëŠ¥ìœ¼ë¡œ ìƒì‚°ì„±ì„ ë”ìš± ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **FireStore**: ë°±ì—”ë“œ ì—†ì´ë„ ê°„ë‹¨í•˜ê³  ë¹ ë¥´ê²Œ ì›ê²©ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## â­ ì£¼ìš” ê¸°ëŠ¥
![20230425172814](https://user-images.githubusercontent.com/56298540/234221995-52e345c9-4a71-4a95-8b13-c05f547bdc84.gif)

### ğŸ“„ ë©”ì„¸ì§€ CRUD
#### 1. ë©”ì„¸ì§€ GET + DELETE
* ë™ì‘ ìˆœì„œ: ì „ì†¡ ë²„íŠ¼ í´ë¦­ -> ì „ì²´ ë°ì´í„° GETìš”ì²­ (`getDocs`) -> ì‚¬ìš©ë  í•œê°œì˜ ë°ì´í„° ì„ íƒ(`selectedData`) -> í•´ë‹¹ ë°ì´í„° firestoreì— ì‚­ì œìš”ì²­ ('deleteDoc`)
* íš¨ê³¼: getìš”ì²­ í›„ deleteìš”ì²­ì´ ë°”ë¡œ ì´ì–´ì ¸ ì‚¬ìš©ìê°€ ë°›ëŠ” ë©”ì„¸ì§€ ì¤‘ë³µ ë°©ì§€
<h5>ğŸ’¾ getMessage.ts</h5>

* Firebase Firestoreì™€ ìƒí˜¸ì‘ìš©í•˜ì—¬ ë©”ì„¸ì§€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì‚­ì œí•˜ëŠ” ë¡œì§ êµ¬í˜„
* getRandomNum í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ëœë¤í•œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ data ë°°ì—´ì—ì„œ ë°ì´í„° ì„ íƒ


```ts
const getMessage = async () => {
	try {
		const response = await getDocs(baseDB())
		const data = response.docs.map((doc) => ({
			...(doc.data() as docInterface),
			id: doc.id,
		}))
		const selectedData = data[getRandomNum(data.length - 1)]
		await deleteDoc(doc(firebaseDB, 'Messages', selectedData.id))
		return selectedData
	} catch (error) {
		console.error('Error in getMessage:', error)
		return undefined
	}
}
```
#### 2. ë©”ì„¸ì§€ Create

<h5>ğŸ’¾ createMessage.ts</h5>

*  Firestoreì— ìƒˆë¡œìš´ ë©”ì‹œì§€ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜

```ts
export const createMessage = async (message: MessageFormInterface) => {
	try {
		await addDoc(baseDB(), message);
	} catch (error) {
		console.error('Error in createMessage:', error);
    return undefined
	}
};
```

### ğŸ“„ ì „ì—­ ìƒíƒœ ê´€ë¦¬ with Recoil

<h5>ğŸ’¾ recoilMessageState.ts</h5>

* React ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ Recoilì„ ì‚¬ìš©í•˜ì—¬ ë©”ì„¸ì§€ ë¦¬ìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•˜ëŠ” ì•„í†°ê³¼ ì…€ë ‰í„° ì •ì˜
* ìƒˆë¡œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ì¸ `newValue`ì˜ íƒ€ì…ì„ ëª…ì‹œí•´ íƒ€ì… ì•ˆì •ì„± ê³ ë ¤

```ts
export const messageListAtom = atom<MessageInterface[]>({
	key: 'messageListState',
	default: [],
})

export const messageSelector = selector({
	key: 'messageListSelector',
	get: ({ get }) => get(messageListAtom),
	set: ({ set }, newValue: MessageInterface[]) => {
		set(messageListAtom, newValue)
	},
})
```
<h5>ğŸ’¾ GetStart.ts</h5>

* useRecoilValue í›…ì„ ì‚¬ìš©í•˜ì—¬ messageSelector ì…€ë ‰í„°ì˜ ê°’ì„ ì‚¬ìš©
* ChattingBoxì— Propsë¡œ ì „ë‹¬í•´ ì»´í¬ë„ŒíŠ¸ ì¬í™œìš© 

```ts
const GetStart = () => {
	const description = PROFECT_DESCRIPTION
	const messageList = useRecoilValue<MessageInterface[]>(messageSelector)
	const [isChatboxOpen, setIsChatboxOpen] = useRecoilState(
		chatBoxModalStateAtom,
	)
	return (
		<div className="start__container">
			<Layout>
				<Logo />
				<SpeechBubble text={description} bubbleState={'default'} />
				<MessageList />
				<Footer />
			</Layout>
			{isChatboxOpen && (
				<ChattingBox
					setIsChatboxOpen={setIsChatboxOpen}
					name={messageList[messageList.length - 1]?.name}
					message={messageList[messageList.length - 1]?.message}
					receivedMessage={messageList[messageList.length - 1]?.receivedMessage}
					state="chatBox"
				/>
			)}
		</div>
	)
}
```
### ğŸ“„ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ handler custom hook

* ì—­í• : ëª¨ë‹¬ì˜ ë°”ê¹¥ ì˜ì—­ì„ í´ë¦­í–ˆì„ ë•Œë„ ì°½ì´ ë‹«í˜
* useRefë¥¼ ì‚¬ìš©í•˜ì—¬ modalRefë¼ëŠ” HTMLDivElement ì°¸ì¡°
* ëª¨ë°”ì¼ í™˜ê²½ì„ ê³ ë ¤í•´ í„°ì¹˜ ì´ë²¤íŠ¸ ì¶”ê°€
* ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ê±°ë‚˜ ì˜ì¡´ì„±ì´ ë³€ê²½ë˜ì—ˆì„ë•Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤í„°ë¥¼ ì œê±°í•˜ê¸° ìœ„í•´ clean-up í•¨ìˆ˜ ë°˜í™˜
* event?.target as Nodeì™€ ê°™ì´ ì˜µì…”ë„ ì²´ì´ë‹ê³¼ íƒ€ì… ë‹¨ì–¸ì„ í†µí•´ eventê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ìœ ë„

<h5>ğŸ’¾ useModal.ts</h5>

```ts
const useModal = (setIsOpen: SetterOrUpdater<boolean>) => {
	const modalRef = useRef<HTMLDivElement>(null)
	useEffect(() => {
		const modalHandler = (event: MouseEvent | TouchEvent) => {
			if (modalRef.current && !modalRef.current.contains(event?.target as Node))
				setIsOpen(false)
		}

		document.addEventListener('mousedown', modalHandler)
		document.addEventListener('touchstart', modalHandler)

		return () => {
			document.removeEventListener('mousedown', modalHandler)
			document.removeEventListener('touchstart', modalHandler)
		}
	})

	return modalRef
}
```

### ğŸ“„ message Form Input custom hook

* Message Form Recoil ìƒíƒœ ê´€ë¦¬ë¥¼ ìœ„í•œ hook
* messageFormAtom ìƒíƒœì˜ ê°’ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” setMessageForm í•¨ìˆ˜ì™€, ì…ë ¥ ê°’ì´ ë³€ê²½ë  ë•Œ í˜¸ì¶œë˜ëŠ” handleInputChange í•¨ìˆ˜ë¥¼ ë°˜í™˜

<h5>ğŸ’¾ useMessageFormInput</h5>

```ts
const useMessageFormInput = () => {
	const setMessageForm =
		useSetRecoilState<MessageFormInterface>(messageFormAtom)

	const handleInputChange = (
		event: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>,
	) => {
		const { id, value } = event.target
		setMessageForm((prevState) => ({
			...prevState,
			[id]: value,
		}))
	}

	return handleInputChange
}
```
### ğŸ“„ ë°˜ì‘í˜• ë””ìì¸ ê³ ë ¤

* ëª¨ë°”ì¼ í™˜ê²½ì„ ê³ ë ¤í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ì„ ìµœì í™”í•˜ê¸° ìœ„í•´ ìš°ë¦¬ëŠ” ë°˜ì‘í˜• ë””ìì¸ì„ ë„ì…

![20230425184737](https://user-images.githubusercontent.com/56298540/234241029-8dc6ddc4-2679-489e-bd4c-d32f0ddefe1e.gif)
